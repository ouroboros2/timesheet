<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Dashboard</title>

<link th:href="@{https://pro.fontawesome.com/releases/v5.10.0/css/all.css}" rel="stylesheet" />
<link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css}" rel="stylesheet" />

<script type="application/javascript" th:src="@{js/jquery-3.5.1.min.js}"></script>
<script type="application/javascript" th:src="@{https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js}"></script>
<script type="application/javascript" th:src="@{https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
<script type="application/javascript" th:src="@{https://cdnjs.cloudflare.com/ajax/libs/datejs/1.0/date.min.js}"></script>

<link th:href="@{https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css}" rel="stylesheet" />
<script type="application/javascript" th:src="@{https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.js}"></script>

<link th:href="@{css/style.css}" rel="stylesheet" />
<script type="application/javascript" th:src="@{js/add_validation.js}"></script>
<script type="application/javascript" th:src="@{js/addProfile.js}"></script>
</head>

<body>

	<!-- NAVBAR -->
	<nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #2b3e40;">
		<div class="container-fluid">
			<a href="#" class="navbar-brand fw-bold">Timesheet Portal</a>
			<ul class="navbar-nav">
				<li class="nav-item dropdown">
					<a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
					<i class="fas fa-user" style="padding-right: 10px;"></i>Admin</a>
					<div class="dropdown-menu">
						<a class="dropdown-item" th:href="@{/login}" id="logout">Logout</a>
					</div>
				</li>
			</ul>
		</div>
	</nav>

	<!-- CONTENT -->
	<div class="container-fluid gray-text-color">
		<div class="row mx-2 mt-3">
			<main role="main" class="col-md-9 ml-sm-auto col-lg-12 pt-3 px-4">
				<div
					class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">
					<h4>Dashboard</h4>
				</div>

				<!-- HEADER -->
				<div class="row shadow gray-text-color p-1 ps-4 mx-1 my-4 bg-body rounded" >

					<div class="col-md">
						<span class="align-middle fw-bold" id="weekfromdate">Week 1</span>
					</div>

					<!-- DATE -->
					<div class="col-md text-center">
						<span id="daterange" class="align-middle fw-bold">Date Range</span>
					</div>

					<div class="col-md dropdown text-end">
						<a class="btn btn-sm btn-outline-none gray-text-color dropdown-toggle"
							id="btnDropdown" data-toggle="dropdown" aria-expanded="false">
							<i class="fas fa-cog me-1"></i>Settings
						</a>
						
						<ul class="dropdown-menu" aria-labelledby="btnDropdown">
							<li><a class="dropdown-item" data-toggle="modal" th:href="@{#addProfileModal}">Add Profile</a></li>
							<li><a class="dropdown-item" data-toggle="modal" th:href="@{#addTaskModal}">Add Project Task</a></li>
							<!--<li><a class="dropdown-item" th:href="@{/newProject}">Add Project Task</a></li> -->
						</ul>
					</div>
				</div>
				
				<!-- ADD PROFILE MODAL -->
				<div class="modal fade bd-example-modal-lg" tabindex="-1"
					role="dialog" id="addProfileModal"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered  modal-lg">
						<div class="modal-content">

							<div class="row p-3 overflow-auto">
								
								<form th:action="@{/saveNewEmployee}" method="post" th:object="${employee}">
									<div class="form-group">
										<label for="userFname">First Name</label>
										<input th:field="*{firstName}" class="form-control" type="text"
											name="userFname" placeholder="First Name" required>
									</div>

									<div class="form-group">
										<label for="userLname">Last Name</label>
										<input th:field="*{lastName}" class="form-control" type="text"
											name="userLname" placeholder="Last Name" required>
									</div>

									<div class="row">
										<div class="col-md-6">
											<div class="form-group">
												<label for="type">Role</label>
												<select class="form-control"
													th:field="*{role}"
													th:onchange="getRole(this)"
													name="userType" required>
													<option th:value="employee">Employee</option>
													<option th:value="manager">Manager</option>
													<option th:value="admin">Admin</option>
												</select>
											</div>
										</div>

										<div class="col-md-6">
											<div class="form-group" id="field_manager">
												<label for="userManager">Manager</label>
												<select th:field="*{managerId}" id="field_manager"
													class="form-control" name="userManager">
													<option th:each="manager: ${managers}"
														th:value="${manager.employeeId}"
														th:text="${manager.firstName} + ' ' + ${manager.lastName}">
													</option>
												</select>
											</div>
										</div>
									</div>

									<div class="form-group">
										<label for="userUname">Username</label> <input
											th:field="*{userName}" class="form-control" type="text"
											name="userUname" placeholder="Username" required>
									</div>

									<div class="row">
										<div class="col-md-6">
											<div class="form-group">
												<div class="form-group">
													<label for="field_pass">Password</label> <input
														th:field="*{password}" class="form-control"
														type="password" id="pass" placeholder="Password" required>
												</div>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group">
												<div class="form-group">
													<label for="confpass">Confirm Password</label> <input
														class="form-control" type="password" id="confpass"
														placeholder="Password" th:onchange="comparePass()"
														required>
												</div>
											</div>
										</div>
									</div>
								</form>

								<div class="col-md d-flex justify-content-end mt-4">
									<button class="btn btn-sm btn-success  me-2" id="submit"
										th:onclick="validate()" style="background-color: #246358;">Submit</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				
				<!-- ADD TASK MODAL -->
				<!-- <div class="modal fade bd-example-modal-lg" tabindex="-1"
					role="dialog" id="addTaskModal"
					aria-hidden="true">
					<div class="modal-dialog modal-dialog-centered  modal-lg">
						<div class="modal-content">

							<div class="row p-3 overflow-auto">

								<form th:action="@{/saveProject}" method="post" th:object="${project}">
									<div class="form-group">
										<label for="tskTitle">Project Code</label> <input
											th:field="*{projectCode}" class="form-control" type="text"
											name="tskTitle" placeholder="Title" required>
									</div>

									<div class="form-group">
										<label for="type">Project Owner</label>
										<select class="form-control" th:field="*{projectOwner}" name="projectOwner" required>
											<option th:each="manager: ${managers}" th:value="${manager.employeeId}"
												th:text="${manager.firstName} + ' ' + ${manager.lastName}">
											</option>
										</select>
									</div>

									<div class="form-group">
										<label for="tskType">Type</label>
										<select th:field="*{category}" class="form-control" name="tskType" required>
											<option th:value="Billable" th:text="Billable"></option>
											<option th:value="Non-Billable" th:text="Non-Billable"></option>
										</select>
									</div>

									<div class="form-group">
										<label for="tskStartDate">Start Date</label> <input
											th:field="*{startDate}" type="date" class="form-control"
											id="tskStartDate" name="tskStartDate"
											data-toggle="datepicker" placeholder="YYYY-MM-DD" required>
										<div data-toggle="datepicker"></div>
									</div>

									<div class="form-group">
										<label for="tskEndDate">End Date</label> <input
											th:field="*{endDate}" type="date" class="form-control"
											id="tskEndDate" name="tskEndDate" data-toggle="datepicker"
											placeholder="YYYY-MM-DD" required>
										<div data-toggle="datepicker"></div>
									</div>

									<div class="form-group">
										<label for="tskDesc">Description</label>
										<textarea th:field="*{projectDesc}" class="form-control"
											name="tskDesc" rows="3" maxlength="300"></textarea>
									</div>
								</form>

								<div class="col-md d-flex justify-content-end mt-4">
									<button class="btn btn-sm btn-success  me-2" id="submit"
										th:onclick="validate()" style="background-color: #246358;">Submit</button>
								</div>
							</div>
						</div>
					</div>
				</div>
				-->
				
				<!-- CONTAINER -->
                <div class="row p-1 mx-1 my-5">

                    <!-- NAVIGATION TABS -->
                    <ul class="nav nav-tabs text-center" style="font-size: 15px;">
                        <li class="nav-item">
                            <a href="#tasks" class="nav-link gray-text-color active" data-toggle="tab">Project Tasks</a>
                        </li>
                        <li class="nav-item">
                            <a href="#employees" class="nav-link gray-text-color" data-toggle="tab">Employees</a>
                        </li>
                    </ul>

					<div class="tab-content overflow-auto gray-text-color" style="max-height: 70vh;">

                        <div class="d-flex justify-content-between my-2">
                        
                           <!-- Form commented since Ajax will be used -->
                           <!-- <form class="d-flex input-group-sm"> -->
                                <input id="empEntry" class="form-control" type="search" placeholder="Search" aria-label="Search">
                                <button class="btn btn-sm" th:onclick="	Employee()"><i class="fas fa-search"></i></button>
                           <!-- </form> -->
                            
                            <div>
	                            <button class="btn btn-sm btn-outline-success">+ ADD</button>
	                            
	                            <!-- unhide these if selection was made -->
	                            <button class="btn btn-sm btn-outline-primary" hidden="hidden">Edit</button>
	                            <button class="btn btn-sm btn-outline-danger"  hidden="hidden">- Delete</button>
	                    	</div>
                        </div>

                        <!-- TASKS -->
                        <div class="tab-pane fade show active" id="tasks">

                            <table class="table table-hover border gray-text-color" id="tableTasks">
                                <thead>
                                    <tr>
                                        <th style="width: 10%;">ID</th>
                                        <th style="width: 30%;">Project Code</th>
                                        <th style="width: 15%;">Category</th>
                                        <th style="width: 15%;">Start Date</th>
                                        <th style="width: 15%;">End Date</th>
                                        <th style="width: 15%;">Assigned to</th>
                                    </tr>
                                </thead>
                                <tbody>
                                	<tr th:each="project: ${projects}">
                                		<td th:text="'PRJTSK' + ${project.projectId}"></td>
                                		<td th:text="${project.projectCode}"></td>
                                		<td th:text="${project.category}"></td>
                                		<td th:text="${project.startDate}"></td>
                                		<td th:text="${project.endDate}"></td>
                                		<td></td>
                                	</tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- EMPLOYEES -->
                        <div class="tab-pane fade" id="employees">

                            <table class="table table-hover border gray-text-color" id="tableEmployees">
                                <thead>
                                    <tr>
                                        <th style="width: 12%;">ID</th>
                                        <th style="width: 35%;">Name</th>
                                        <th style="width: 17%;">Username</th>
                                        <th style="width: 16%;">Password</th>
                                        <th style="width: 20%;">Manager</th>
                                    </tr>
                                </thead>
                                <tbody>
                                	<tr th:each="employee: ${employees}">
                                		<td th:text="${employee.employeeId}"></td>
                                		<td th:text="${employee.firstName} + ' ' + ${employee.lastName}"></td>
                                		<td th:text="${employee.userName}"></td>
                                		<td th:text="${employee.password}"></td>
                                		<td th:text="${employee.managerId}"></td>
                                	</tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
			</main>
		</div>
	</div>
	
	<script type="application/javascript" th:src="@{js/admin_homepage.js}"></script>
</body>
</html>